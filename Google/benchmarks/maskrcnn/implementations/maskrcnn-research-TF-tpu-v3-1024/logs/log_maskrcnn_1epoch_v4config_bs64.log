:::MLL 1610736074.348 cache_clear: {"value": true, "metadata": {"file": "mask_rcnn_main.py", "lineno": 118}}
I0115 18:41:14.347747 139891247965952 mlp_log.py:82] :::MLL 1610736074.348 cache_clear: {"value": true, "metadata": {"file": "mask_rcnn_main.py", "lineno": 118}}
:::MLL 1610736074.348 init_start: {"value": null, "metadata": {"file": "mask_rcnn_main.py", "lineno": 119}}
I0115 18:41:14.348360 139891247965952 mlp_log.py:82] :::MLL 1610736074.348 init_start: {"value": null, "metadata": {"file": "mask_rcnn_main.py", "lineno": 119}}
:::MLL 1610736074.349 global_batch_size: {"value": 64, "metadata": {"file": "mask_rcnn_main.py", "lineno": 120}}
I0115 18:41:14.348777 139891247965952 mlp_log.py:82] :::MLL 1610736074.349 global_batch_size: {"value": 64, "metadata": {"file": "mask_rcnn_main.py", "lineno": 120}}
:::MLL 1610736074.349 train_samples: {"value": 118287, "metadata": {"file": "mask_rcnn_main.py", "lineno": 121}}
I0115 18:41:14.349168 139891247965952 mlp_log.py:82] :::MLL 1610736074.349 train_samples: {"value": 118287, "metadata": {"file": "mask_rcnn_main.py", "lineno": 121}}
:::MLL 1610736074.350 eval_samples: {"value": 5000, "metadata": {"file": "mask_rcnn_main.py", "lineno": 122}}
I0115 18:41:14.349572 139891247965952 mlp_log.py:82] :::MLL 1610736074.350 eval_samples: {"value": 5000, "metadata": {"file": "mask_rcnn_main.py", "lineno": 122}}
:::MLL 1610736074.350 min_image_size: {"value": 800, "metadata": {"file": "mask_rcnn_main.py", "lineno": 124}}
I0115 18:41:14.349977 139891247965952 mlp_log.py:82] :::MLL 1610736074.350 min_image_size: {"value": 800, "metadata": {"file": "mask_rcnn_main.py", "lineno": 124}}
:::MLL 1610736074.350 max_image_size: {"value": 1333, "metadata": {"file": "mask_rcnn_main.py", "lineno": 126}}
I0115 18:41:14.350377 139891247965952 mlp_log.py:82] :::MLL 1610736074.350 max_image_size: {"value": 1333, "metadata": {"file": "mask_rcnn_main.py", "lineno": 126}}
:::MLL 1610736074.351 num_image_candidates: {"value": 1000, "metadata": {"file": "mask_rcnn_main.py", "lineno": 128}}
I0115 18:41:14.350823 139891247965952 mlp_log.py:82] :::MLL 1610736074.351 num_image_candidates: {"value": 1000, "metadata": {"file": "mask_rcnn_main.py", "lineno": 128}}
I0115 18:41:14.513829 139891247965952 transport.py:157] Attempting refresh to obtain initial access_token
INFO:tensorflow:enable_2d_tiling: False
I0115 18:41:20.263824 139891247965952 device_assignment.py:344] enable_2d_tiling: False
WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/dataloader.py:417: to_int64 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0115 18:41:20.330593 139891247965952 deprecation.py:323] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/dataloader.py:417: to_int64 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
WARNING:tensorflow:Entity <function InputReader.__call__.<locals>._prefetch_dataset at 0x7f3acdd37ae8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Bad argument number for Name: 3, expecting 4
W0115 18:41:20.353699 139891247965952 ag_logging.py:146] Entity <function InputReader.__call__.<locals>._prefetch_dataset at 0x7f3acdd37ae8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Bad argument number for Name: 3, expecting 4
WARNING:tensorflow:Entity <function InputReader.__call__.<locals>._dataset_parser at 0x7f3ac37d50d0> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
W0115 18:41:20.406541 139891247965952 ag_logging.py:146] Entity <function InputReader.__call__.<locals>._dataset_parser at 0x7f3ac37d50d0> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/object_detection/tf_example_decoder.py:135: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0115 18:41:20.495945 139891247965952 deprecation.py:323] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/object_detection/tf_example_decoder.py:135: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/object_detection/tf_example_decoder.py:146: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0115 18:41:20.513023 139891247965952 deprecation.py:323] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/object_detection/tf_example_decoder.py:146: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/dataloader.py:316: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0115 18:41:20.584437 139891247965952 deprecation.py:323] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/dataloader.py:316: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/dataloader.py:317: The name tf.string_to_number is deprecated. Please use tf.strings.to_number instead.

W0115 18:41:20.585594 139891247965952 module_wrapper.py:139] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/dataloader.py:317: The name tf.string_to_number is deprecated. Please use tf.strings.to_number instead.

WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/dataloader.py:115: The name tf.image.resize_images is deprecated. Please use tf.image.resize instead.

W0115 18:41:20.655061 139891247965952 module_wrapper.py:139] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/dataloader.py:115: The name tf.image.resize_images is deprecated. Please use tf.image.resize instead.

WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/dataloader.py:205: calling crop_and_resize_v1 (from tensorflow.python.ops.image_ops_impl) with box_ind is deprecated and will be removed in a future version.
Instructions for updating:
box_ind is deprecated, use box_indices instead
W0115 18:41:20.745788 139891247965952 deprecation.py:506] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/dataloader.py:205: calling crop_and_resize_v1 (from tensorflow.python.ops.image_ops_impl) with box_ind is deprecated and will be removed in a future version.
Instructions for updating:
box_ind is deprecated, use box_indices instead
WARNING:tensorflow:Entity <function InputReader.__call__.<locals>.reduce_func at 0x7f3a9ff356a8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Bad argument number for Name: 3, expecting 4
W0115 18:41:21.492158 139891247965952 ag_logging.py:146] Entity <function InputReader.__call__.<locals>.reduce_func at 0x7f3a9ff356a8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Bad argument number for Name: 3, expecting 4
WARNING:tensorflow:Entity <bound method InputReader._transform_images of <dataloader.InputReader object at 0x7f3acde0d400>> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
W0115 18:41:21.522588 139891247965952 ag_logging.py:146] Entity <bound method InputReader._transform_images of <dataloader.InputReader object at 0x7f3acde0d400>> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/util/train_and_eval_runner.py:265: DatasetV1.make_initializable_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_initializable_iterator(dataset)`.
W0115 18:41:21.552741 139891247965952 deprecation.py:323] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/util/train_and_eval_runner.py:265: DatasetV1.make_initializable_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_initializable_iterator(dataset)`.
WARNING:tensorflow:Entity <function InputReader.__call__.<locals>._prefetch_dataset at 0x7f3acdd37c80> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Bad argument number for Name: 3, expecting 4
W0115 18:41:21.680768 139891247965952 ag_logging.py:146] Entity <function InputReader.__call__.<locals>._prefetch_dataset at 0x7f3acdd37c80> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Bad argument number for Name: 3, expecting 4
WARNING:tensorflow:Entity <function InputReader.__call__.<locals>._dataset_parser at 0x7f3acf691a60> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
W0115 18:41:21.721185 139891247965952 ag_logging.py:146] Entity <function InputReader.__call__.<locals>._dataset_parser at 0x7f3acf691a60> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <function InputReader.__call__.<locals>.horizontal_image at 0x7f3acdd37d90> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
W0115 18:41:22.017568 139891247965952 ag_logging.py:146] Entity <function InputReader.__call__.<locals>.horizontal_image at 0x7f3acdd37d90> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <function InputReader.__call__.<locals>._mark_is_padding at 0x7f3acdd37950> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
W0115 18:41:22.033462 139891247965952 ag_logging.py:146] Entity <function InputReader.__call__.<locals>._mark_is_padding at 0x7f3acdd37950> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <function InputReader.__call__.<locals>.vertical_image at 0x7f3acdd37510> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Bad argument number for Name: 3, expecting 4
W0115 18:41:22.048733 139891247965952 ag_logging.py:146] Entity <function InputReader.__call__.<locals>.vertical_image at 0x7f3acdd37510> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Bad argument number for Name: 3, expecting 4
WARNING:tensorflow:Entity <function InputReader.__call__.<locals>._mark_is_not_padding at 0x7f3a9fe9a268> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
W0115 18:41:22.077094 139891247965952 ag_logging.py:146] Entity <function InputReader.__call__.<locals>._mark_is_not_padding at 0x7f3a9fe9a268> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <function InputReader.__call__.<locals>.reduce_func at 0x7f3a9ff3e400> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Bad argument number for Name: 3, expecting 4
W0115 18:41:22.100700 139891247965952 ag_logging.py:146] Entity <function InputReader.__call__.<locals>.reduce_func at 0x7f3a9ff3e400> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Bad argument number for Name: 3, expecting 4
WARNING:tensorflow:Entity <bound method InputReader._transform_images of <dataloader.InputReader object at 0x7f3acde0d438>> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
W0115 18:41:22.123276 139891247965952 ag_logging.py:146] Entity <bound method InputReader._transform_images of <dataloader.InputReader object at 0x7f3acde0d438>> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: module 'gast' has no attribute 'Index'
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
W0115 18:41:22.232415 139891247965952 deprecation.py:506] From /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1848
1848
8
loading annotations into memory...
Done (t=0.71s)
creating index...
index created!
************* 1
<tensorflow.python.tpu.device_assignment.DeviceAssignment object at 0x7f3acdd5e0b8>
:::MLL 1610736082.244 opt_learning_rate_decay_factor: {"value": 0.1, "metadata": {"file": "/home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/lr_policy.py", "lineno": 38}}
I0115 18:41:22.243903 139891247965952 mlp_log.py:82] :::MLL 1610736082.244 opt_learning_rate_decay_factor: {"value": 0.1, "metadata": {"file": "/home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/lr_policy.py", "lineno": 38}}
:::MLL 1610736082.245 opt_learning_rate_decay_steps: {"value": [9750, 13000], "metadata": {"file": "/home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/lr_policy.py", "lineno": 40}}
I0115 18:41:22.245243 139891247965952 mlp_log.py:82] :::MLL 1610736082.245 opt_learning_rate_decay_steps: {"value": [9750, 13000], "metadata": {"file": "/home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/lr_policy.py", "lineno": 40}}
:::MLL 1610736082.259 opt_base_learning_rate: {"value": 0.16, "metadata": {"file": "/home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_model.py", "lineno": 117}}
I0115 18:41:22.259168 139891247965952 mlp_log.py:82] :::MLL 1610736082.259 opt_base_learning_rate: {"value": 0.16, "metadata": {"file": "/home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_model.py", "lineno": 117}}
:::MLL 1610736082.260 opt_learning_rate_warmup_steps: {"value": 1000, "metadata": {"file": "/home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_model.py", "lineno": 120}}
I0115 18:41:22.260506 139891247965952 mlp_log.py:82] :::MLL 1610736082.260 opt_learning_rate_warmup_steps: {"value": 1000, "metadata": {"file": "/home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_model.py", "lineno": 120}}
:::MLL 1610736082.262 opt_learning_rate_warmup_factor: {"value": 0.00016, "metadata": {"file": "/home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_model.py", "lineno": 123}}
I0115 18:41:22.261685 139891247965952 mlp_log.py:82] :::MLL 1610736082.262 opt_learning_rate_warmup_factor: {"value": 0.00016, "metadata": {"file": "/home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_model.py", "lineno": 123}}
WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/resnet.py:73: batch_normalization (from tensorflow.python.layers.normalization) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.BatchNormalization instead.  In particular, `tf.control_dependencies(tf.GraphKeys.UPDATE_OPS)` should not be used (consult the `tf.keras.layers.batch_normalization` documentation).
W0115 18:41:22.319026 139891247965952 deprecation.py:323] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/resnet.py:73: batch_normalization (from tensorflow.python.layers.normalization) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.BatchNormalization instead.  In particular, `tf.control_dependencies(tf.GraphKeys.UPDATE_OPS)` should not be used (consult the `tf.keras.layers.batch_normalization` documentation).
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/layers/normalization.py:327: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
W0115 18:41:22.319689 139891247965952 deprecation.py:323] From /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/layers/normalization.py:327: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/resnet.py:449: max_pooling2d (from tensorflow.python.layers.pooling) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.MaxPooling2D instead.
W0115 18:41:22.344201 139891247965952 deprecation.py:323] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/resnet.py:449: max_pooling2d (from tensorflow.python.layers.pooling) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.MaxPooling2D instead.
WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/resnet.py:113: conv2d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.keras.layers.Conv2D` instead.
W0115 18:41:22.347332 139891247965952 deprecation.py:323] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/resnet.py:113: conv2d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.keras.layers.Conv2D` instead.
WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:419: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

W0115 18:41:24.387146 139891247965952 module_wrapper.py:139] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:419: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:419: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

W0115 18:41:24.387415 139891247965952 module_wrapper.py:139] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:419: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:1417: The name tf.floordiv is deprecated. Please use tf.math.floordiv instead.

W0115 18:41:27.052174 139891247965952 module_wrapper.py:139] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:1417: The name tf.floordiv is deprecated. Please use tf.math.floordiv instead.

WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:1417: The name tf.log is deprecated. Please use tf.math.log instead.

W0115 18:41:27.052470 139891247965952 module_wrapper.py:139] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:1417: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:1417: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0115 18:41:27.052618 139891247965952 deprecation.py:323] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:1417: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:470: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

W0115 18:41:27.428595 139891247965952 module_wrapper.py:139] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:470: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:531: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
W0115 18:41:27.466960 139891247965952 deprecation.py:323] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:531: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:631: conv2d_transpose (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.keras.layers.Conv2DTranspose` instead.
W0115 18:41:28.393527 139891247965952 deprecation.py:323] From /home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/mask_rcnn_architecture.py:631: conv2d_transpose (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.keras.layers.Conv2DTranspose` instead.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/util/dispatch.py:180: batch_gather (from tensorflow.python.ops.array_ops) is deprecated and will be removed after 2017-10-25.
Instructions for updating:
`tf.batch_gather` is deprecated, please use `tf.gather` with `batch_dims=-1` instead.
W0115 18:41:52.951244 139891247965952 deprecation.py:323] From /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/util/dispatch.py:180: batch_gather (from tensorflow.python.ops.array_ops) is deprecated and will be removed after 2017-10-25.
Instructions for updating:
`tf.batch_gather` is deprecated, please use `tf.gather` with `batch_dims=-1` instead.
INFO:tensorflow:{'images': <tf.Tensor 'Slice_1:0' shape=(279552, 8, 12) dtype=bfloat16>, 'source_ids': <tf.Tensor 'Slice_3:0' shape=(8,) dtype=float32>, 'image_info': <tf.Tensor 'Slice:0' shape=(8, 5) dtype=float32>, 'is_padded': <tf.Tensor 'Slice_2:0' shape=(8, 1) dtype=bool>}
I0115 18:42:03.627734 139891247965952 mask_rcnn_model.py:290] {'images': <tf.Tensor 'Slice_1:0' shape=(279552, 8, 12) dtype=bfloat16>, 'source_ids': <tf.Tensor 'Slice_3:0' shape=(8,) dtype=float32>, 'image_info': <tf.Tensor 'Slice:0' shape=(8, 5) dtype=float32>, 'is_padded': <tf.Tensor 'Slice_2:0' shape=(8, 1) dtype=bool>}
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/client/session.py", line 1365, in _do_call
    return fn(*args)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/client/session.py", line 1350, in _run_fn
    target_list, run_metadata)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/client/session.py", line 1443, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: From /job:tpu_worker/replica:0/task:0:
Compilation failure: Ran out of memory in memory space hbm. Used 21.45G of 16.00G hbm. Exceeded hbm capacity by 5.45G.

Total hbm usage >= 21.45G:
    reserved        528.00M 
    program          20.94G 
    arguments       unknown size 

Output size unknown.

Program hbm requirement 20.94G:
    reserved           4.0K
    global          588.19M
    HLO temp         20.36G (90.3% utilization, 0.1% fragmentation (14.09M))

  Largest program allocations in hbm:

  1. Size: 10.25G
     Operator: op_type="Reshape" op_name="faster_rcnn_heads/multilevel_crop_and_resize/einsum/Reshape_2"
     Shape: bf16[8,256,336,1000,7]{2,1,4,3,0:T(8,128)(2,1)}
     Unpadded size: 8.97G
     Extra memory due to padding: 1.28G (1.1x expansion)
     XLA label: %reshape.27879 = bf16[8,256,336,1000,7]{2,1,4,3,0:T(8,128)(2,1)} reshape(bf16[8,86016,7000]{1,2,0:T(8,128)(2,1)} %convolution-base-dilated.134), metadata={op_type="Reshape" op_name="faster_rcnn_heads/multilevel_crop_and_resize/einsum/Reshape_2"}
     Allocation type: HLO temp
     ==========================

  2. Size: 9.19G
     Operator: op_type="Transpose" op_name="faster_rcnn_heads/multilevel_crop_and_resize/einsum_1/transpose"
     Shape: bf16[8,1000,256,7,336]{1,0,4,3,2:T(8,128)(2,1)}
     Unpadded size: 8.97G
     Extra memory due to padding: 220.50M (1.0x expansion)
     XLA label: %copy.51396 = bf16[8,1000,256,7,336]{1,0,4,3,2:T(8,128)(2,1)} copy(bf16[8,1000,256,7,336]{4,2,3,1,0:T(8,128)(2,1)} %bitcast.1497), metadata={op_type="Transpose" op_name="faster_rcnn_heads/multilevel_crop_and_resize/einsum_1/transpose"}
     Allocation type: HLO temp
     ==========================

  3. Size: 546.00M
     Shape: bf16[279552,8,12]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 51.19M
     Extra memory due to padding: 494.81M (10.7x expansion)
     XLA label: %reshape.49426 = bf16[279552,8,12]{2,1,0:T(8,128)(2,1)} reshape(bf16[26836992]{0:T(1024)(2,1)} %get-tuple-element.94586)
     Allocation type: HLO temp
     ==========================

  4. Size: 273.00M
     Shape: bf16[8,86016,208]{1,2,0}
     Unpadded size: 273.00M
     XLA label: %copy.52556 = bf16[8,86016,208]{1,2,0} copy(bf16[8,86016,208]{2,1,0:T(8,128)(2,1)} %bitcast.1489)
     Allocation type: HLO temp
     ==========================

  5. Size: 102.38M
     Shape: bf16[8,52416,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 3.20M
     Extra memory due to padding: 99.18M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  6. Size: 102.38M
     Shape: bf16[8,52416,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 3.20M
     Extra memory due to padding: 99.18M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  7. Size: 102.38M
     Shape: bf16[8,52416,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 3.20M
     Extra memory due to padding: 99.18M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  8. Size: 102.38M
     Shape: bf16[8,52416,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 3.20M
     Extra memory due to padding: 99.18M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  9. Size: 68.25M
     Operator: op_type="Conv2D" op_name="resnet_fpn/post_hoc_d3/Conv2D"
     Shape: bf16[8,104,168,256]{3,0,2,1:T(8,128)(2,1)}
     Unpadded size: 68.25M
     XLA label: %fusion.9140 = bf16[8,104,168,256]{3,0,2,1:T(8,128)(2,1)} fusion(bf16[256]{0:T(512)(2,1)} %convert.10211, bf16[8,104,168,256]{3,0,2,1:T(8,128)(2,1)} %fusion.9142, f32[3,3,256,256]{3,2,1,0:T(8,128)} %get-tuple-element.91906), kind=kOutput, calls=%fused_comp...
     Allocation type: HLO temp
     ==========================

  10. Size: 25.59M
     Shape: bf16[8,13104,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 819.0K
     Extra memory due to padding: 24.79M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  11. Size: 25.59M
     Shape: bf16[8,13104,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 819.0K
     Extra memory due to padding: 24.79M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  12. Size: 25.59M
     Shape: bf16[8,13104,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 819.0K
     Extra memory due to padding: 24.79M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  13. Size: 25.59M
     Shape: bf16[8,13104,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 819.0K
     Extra memory due to padding: 24.79M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  14. Size: 17.06M
     Operator: op_type="Conv2D" op_name="resnet_fpn/post_hoc_d4/Conv2D"
     Shape: bf16[8,52,84,256]{3,0,2,1:T(8,128)(2,1)}
     Unpadded size: 17.06M
     XLA label: %fusion.9259 = bf16[8,52,84,256]{3,0,2,1:T(8,128)(2,1)} fusion(bf16[256]{0:T(512)(2,1)} %convert.10226, bf16[8,52,84,256]{3,0,2,1:T(8,128)(2,1)} %fusion.9261, f32[3,3,256,256]{3,2,1,0:T(8,128)} %get-tuple-element.91908), kind=kOutput, calls=%fused_computat...
     Allocation type: HLO temp
     ==========================

  15. Size: 6.41M
     Shape: bf16[8,3276,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 204.8K
     Extra memory due to padding: 6.21M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  16. Size: 6.41M
     Shape: bf16[8,3276,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 204.8K
     Extra memory due to padding: 6.21M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  17. Size: 6.41M
     Shape: bf16[8,3276,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 204.8K
     Extra memory due to padding: 6.21M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  18. Size: 6.41M
     Shape: bf16[8,3276,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 204.8K
     Extra memory due to padding: 6.21M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  19. Size: 6.25M
     Shape: f32[1600,8,128]{2,1,0:T(8,128)}
     Unpadded size: 6.25M
     XLA label: %while.369 = (s32[]{:T(256)}, u32[]{:T(256)}, u32[]{:T(256)}, f32[7,7,3,64]{3,2,1,0:T(4,128)}, f32[64]{0:T(256)}, f32[64]{0:T(256)}, f32[64]{0:T(256)}, f32[64]{0:T(256)}, f32[1,1,64,256]{3,2,1,0:T(8,128)}, f32[256]{0:T(256)}, f32[256]{0:T(256)}, f32[256]{0...
     Allocation type: HLO temp
     ==========================

  20. Size: 1.61M
     Shape: bf16[8,819,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 51.2K
     Extra memory due to padding: 1.56M (32.2x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================


	TPU compilation failed
	 [[{{node TPUReplicateMetadata}}]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.5/threading.py", line 914, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.5/threading.py", line 862, in run
    self._target(*self._args, **self._kwargs)
  File "/home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/util/train_and_eval_runner.py", line 541, in train_eval_thread_fn
    sess.run([train_eval_op])
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/client/session.py", line 956, in run
    run_metadata_ptr)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/client/session.py", line 1180, in _run
    feed_dict_tensor, options, run_metadata)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/client/session.py", line 1359, in _do_run
    run_metadata)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/client/session.py", line 1384, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: From /job:tpu_worker/replica:0/task:0:
Compilation failure: Ran out of memory in memory space hbm. Used 21.45G of 16.00G hbm. Exceeded hbm capacity by 5.45G.

Total hbm usage >= 21.45G:
    reserved        528.00M 
    program          20.94G 
    arguments       unknown size 

Output size unknown.

Program hbm requirement 20.94G:
    reserved           4.0K
    global          588.19M
    HLO temp         20.36G (90.3% utilization, 0.1% fragmentation (14.09M))

  Largest program allocations in hbm:

  1. Size: 10.25G
     Operator: op_type="Reshape" op_name="faster_rcnn_heads/multilevel_crop_and_resize/einsum/Reshape_2"
     Shape: bf16[8,256,336,1000,7]{2,1,4,3,0:T(8,128)(2,1)}
     Unpadded size: 8.97G
     Extra memory due to padding: 1.28G (1.1x expansion)
     XLA label: %reshape.27879 = bf16[8,256,336,1000,7]{2,1,4,3,0:T(8,128)(2,1)} reshape(bf16[8,86016,7000]{1,2,0:T(8,128)(2,1)} %convolution-base-dilated.134), metadata={op_type="Reshape" op_name="faster_rcnn_heads/multilevel_crop_and_resize/einsum/Reshape_2"}
     Allocation type: HLO temp
     ==========================

  2. Size: 9.19G
     Operator: op_type="Transpose" op_name="faster_rcnn_heads/multilevel_crop_and_resize/einsum_1/transpose"
     Shape: bf16[8,1000,256,7,336]{1,0,4,3,2:T(8,128)(2,1)}
     Unpadded size: 8.97G
     Extra memory due to padding: 220.50M (1.0x expansion)
     XLA label: %copy.51396 = bf16[8,1000,256,7,336]{1,0,4,3,2:T(8,128)(2,1)} copy(bf16[8,1000,256,7,336]{4,2,3,1,0:T(8,128)(2,1)} %bitcast.1497), metadata={op_type="Transpose" op_name="faster_rcnn_heads/multilevel_crop_and_resize/einsum_1/transpose"}
     Allocation type: HLO temp
     ==========================

  3. Size: 546.00M
     Shape: bf16[279552,8,12]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 51.19M
     Extra memory due to padding: 494.81M (10.7x expansion)
     XLA label: %reshape.49426 = bf16[279552,8,12]{2,1,0:T(8,128)(2,1)} reshape(bf16[26836992]{0:T(1024)(2,1)} %get-tuple-element.94586)
     Allocation type: HLO temp
     ==========================

  4. Size: 273.00M
     Shape: bf16[8,86016,208]{1,2,0}
     Unpadded size: 273.00M
     XLA label: %copy.52556 = bf16[8,86016,208]{1,2,0} copy(bf16[8,86016,208]{2,1,0:T(8,128)(2,1)} %bitcast.1489)
     Allocation type: HLO temp
     ==========================

  5. Size: 102.38M
     Shape: bf16[8,52416,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 3.20M
     Extra memory due to padding: 99.18M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  6. Size: 102.38M
     Shape: bf16[8,52416,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 3.20M
     Extra memory due to padding: 99.18M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  7. Size: 102.38M
     Shape: bf16[8,52416,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 3.20M
     Extra memory due to padding: 99.18M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  8. Size: 102.38M
     Shape: bf16[8,52416,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 3.20M
     Extra memory due to padding: 99.18M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  9. Size: 68.25M
     Operator: op_type="Conv2D" op_name="resnet_fpn/post_hoc_d3/Conv2D"
     Shape: bf16[8,104,168,256]{3,0,2,1:T(8,128)(2,1)}
     Unpadded size: 68.25M
     XLA label: %fusion.9140 = bf16[8,104,168,256]{3,0,2,1:T(8,128)(2,1)} fusion(bf16[256]{0:T(512)(2,1)} %convert.10211, bf16[8,104,168,256]{3,0,2,1:T(8,128)(2,1)} %fusion.9142, f32[3,3,256,256]{3,2,1,0:T(8,128)} %get-tuple-element.91906), kind=kOutput, calls=%fused_comp...
     Allocation type: HLO temp
     ==========================

  10. Size: 25.59M
     Shape: bf16[8,13104,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 819.0K
     Extra memory due to padding: 24.79M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  11. Size: 25.59M
     Shape: bf16[8,13104,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 819.0K
     Extra memory due to padding: 24.79M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  12. Size: 25.59M
     Shape: bf16[8,13104,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 819.0K
     Extra memory due to padding: 24.79M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  13. Size: 25.59M
     Shape: bf16[8,13104,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 819.0K
     Extra memory due to padding: 24.79M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  14. Size: 17.06M
     Operator: op_type="Conv2D" op_name="resnet_fpn/post_hoc_d4/Conv2D"
     Shape: bf16[8,52,84,256]{3,0,2,1:T(8,128)(2,1)}
     Unpadded size: 17.06M
     XLA label: %fusion.9259 = bf16[8,52,84,256]{3,0,2,1:T(8,128)(2,1)} fusion(bf16[256]{0:T(512)(2,1)} %convert.10226, bf16[8,52,84,256]{3,0,2,1:T(8,128)(2,1)} %fusion.9261, f32[3,3,256,256]{3,2,1,0:T(8,128)} %get-tuple-element.91908), kind=kOutput, calls=%fused_computat...
     Allocation type: HLO temp
     ==========================

  15. Size: 6.41M
     Shape: bf16[8,3276,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 204.8K
     Extra memory due to padding: 6.21M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  16. Size: 6.41M
     Shape: bf16[8,3276,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 204.8K
     Extra memory due to padding: 6.21M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  17. Size: 6.41M
     Shape: bf16[8,3276,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 204.8K
     Extra memory due to padding: 6.21M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  18. Size: 6.41M
     Shape: bf16[8,3276,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 204.8K
     Extra memory due to padding: 6.21M (32.0x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================

  19. Size: 6.25M
     Shape: f32[1600,8,128]{2,1,0:T(8,128)}
     Unpadded size: 6.25M
     XLA label: %while.369 = (s32[]{:T(256)}, u32[]{:T(256)}, u32[]{:T(256)}, f32[7,7,3,64]{3,2,1,0:T(4,128)}, f32[64]{0:T(256)}, f32[64]{0:T(256)}, f32[64]{0:T(256)}, f32[64]{0:T(256)}, f32[1,1,64,256]{3,2,1,0:T(8,128)}, f32[256]{0:T(256)}, f32[256]{0:T(256)}, f32[256]{0...
     Allocation type: HLO temp
     ==========================

  20. Size: 1.61M
     Shape: bf16[8,819,4]{2,1,0:T(8,128)(2,1)}
     Unpadded size: 51.2K
     Extra memory due to padding: 1.56M (32.2x expansion)
     XLA label: constant literal
     Allocation type: global
     ==========================


	TPU compilation failed
	 [[node TPUReplicateMetadata (defined at /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


Original stack trace for 'TPUReplicateMetadata':
  File "mask_rcnn_main.py", line 237, in <module>
    app.run(main)
  File "/usr/local/lib/python3.5/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.5/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "mask_rcnn_main.py", line 167, in main
    FLAGS.input_partition_dims, init_fn, params=params)
  File "/home/falcon101_hl/training_results_v0.7/Google/benchmarks/maskrcnn/implementations/maskrcnn-research-TF-tpu-v3-1024/util/train_and_eval_runner.py", line 472, in initialize
    device_assignment=self.device_assignment)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/tpu/tpu.py", line 1404, in shard
    name=name)[1]
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/tpu/tpu.py", line 1277, in split_compile_and_shard
    name=name)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/tpu/tpu.py", line 927, in split_compile_and_replicate
    num_replicas=num_replicas, use_tpu=use_tpu, **metadata_kwargs)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/ops/gen_tpu_ops.py", line 6105, in tpu_replicate_metadata
    name=name)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 794, in _apply_op_helper
    op_def=op_def)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/framework/ops.py", line 3357, in create_op
    attrs, op_def, compute_device)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/framework/ops.py", line 3426, in _create_op_internal
    op_def=op_def)
  File "/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

